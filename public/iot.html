<!DOCTYPE html>
<html>
  <head>
    <title>Streaming Chart Example</title>
    <script src="/javascripts/smoothie.js" > </script>
    <script src="/socket.io/socket.io.js" > </script>
    <style type="text/css">
		.tg  {border-collapse:collapse;border-spacing:0;}
		.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
		.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
		.tg .tg-yw4l{vertical-align:top}
    </style>
  </head>
  <body>
    <h1>Berry IMU - Sammamish</h1>
	<script language="javascript">
 			var today = new Date();
 			document.write(today);
 	</script>
 	<br>
<table class="tg">
  <tr>
    <th class="tg-yw4l">Magnetometer</th>
    <th class="tg-yw4l">Accelerator</th>
  </tr>
  <tr>
    <td class="tg-yw4l" align="center"><canvas width="580" height="140" id="magXGraph"></canvas></td>
    <td class="tg-yw4l" align="center"> <canvas width="580" height="140" id="accXGraph"></canvas></td>
  </tr>
  <tr>
    <td class="tg-yw4l" align="center"><canvas width="580" height="140" id="magYGraph"></canvas></td>
    <td class="tg-yw4l" align="center"><canvas width="580" height="150" id="accYGraph"></canvas></td>
  </tr>
  <tr>
    <td class="tg-yw4l" align="center"> <canvas width="580" height="140" id="magZGraph"></canvas></td>
    <td class="tg-yw4l" align="center"><canvas width="580" height="140" id="accZGraph"></canvas></td>
  </tr>
  <tr>
    <th class="tg-yw4l" colspan="2" align = "center">Barometer</th>
  </tr>
  <tr>
    <td class="tg-yw4l" colspan="2" align = "center"><canvas width="1230" height="150" id="barGraph"></canvas></td>
  </tr>
  <tr>
    <th class="tg-yw4l" colspan="2" align = "center">Temperature</th>
  </tr>
  <tr>
    <td class="tg-yw4l" colspan="2"> <canvas width="1230" height="150" id="tempGraph"></canvas></td>
  </tr>
</table>
  
<script>
var magX = new TimeSeries();
var magY = new TimeSeries();
var magZ = new TimeSeries();
var accX = new TimeSeries();
var accY = new TimeSeries();
var accZ = new TimeSeries();
var bar = new TimeSeries();
var temp = new TimeSeries();
var time = new Date().getTime();
  
   function createTimelineMagX() {
       var chartMagX = new SmoothieChart({
    	   maxValue : 450,
	   minValue : 350,
	   maxValueScale : 1.1,
           minValueScale : 1.1,
           millisPerPixel: 30,
           labels:{disabled:false,
		   fillStyle: '#000000'},
	   grid: {fillStyle: '#4072dc'},
           timestampFormatter:SmoothieChart.timeFormatter
       });
       chartMagX.addTimeSeries(magX, {
           strokeStyle: '#ff847d',
           fillStyle: 'rgba(255,108,118,0.30)',
           lineWidth: 1
       });
       chartMagX.streamTo(document.getElementById("magXGraph"), 1000);
   }

   function createTimelineMagY() {
       var chartMagy = new SmoothieChart({
    	   maxValue : 125,
	   minValue : 25,
	   maxValueScale : 1.1,
           minValueScale : 1.1,
           millisPerPixel: 30,
           labels:{disabled:false,
		   fillStyle: '#000000'},
           grid: {fillStyle: '#4072dc'},
           timestampFormatter:SmoothieChart.timeFormatter
       });
       chartMagy.addTimeSeries(magY, {
           strokeStyle: '#f9ff61',
           fillStyle: 'rgba(248,255,192,0.30)',
           lineWidth: 1
       });
       chartMagy.streamTo(document.getElementById("magYGraph"), 1000);
   }
   
   function createTimelineMagZ() {
       var chartMagZ = new SmoothieChart({
    	   maxValue : 900,
	   minValue : 800,
	   maxValueScale : 1.1,
           minValueScale : 1.1,
           millisPerPixel: 30,
           labels:{disabled:false,
		   fillStyle: '#000000'},
           grid: {fillStyle: '#4072dc'},
           timestampFormatter:SmoothieChart.timeFormatter
       });
       chartMagZ.addTimeSeries(magZ, {
           strokeStyle: '#7cff76',
           fillStyle: 'rgba(230,224,46,0.30)',
           lineWidth: 1
       });
       chartMagZ.streamTo(document.getElementById("magZGraph"), 1000);
   }

   function createTimelineAccX() {
       var chartAccX = new SmoothieChart({
           maxValue : -30,
           minValue : -80,
	   maxValueScale : 1.1,
           minValueScale : 1.1,
           millisPerPixel: 30,
           labels:{disabled:false,
		   fillStyle: '#000000'},
           grid: {fillStyle: '#4072dc'},
	   labels:{fillStyle:'#050207'},
           timestampFormatter:SmoothieChart.timeFormatter
       });

       chartAccX.addTimeSeries(accX, {
           strokeStyle: '#ff847d',
           fillStyle: 'rgba(255,108,118,0.30)',
           lineWidth: 1
       });

       chartAccX.streamTo(document.getElementById("accXGraph"), 1000);
   }
   
   function createTimelineAccY() {
       var chartAccY = new SmoothieChart({
           maxValue: -125,
           minValue: -200,
	   maxValueScale : 1.1,
           minValueScale : 1.1,
           millisPerPixel: 30,
           labels:{disabled:false,
		   fillStyle: '#000000'},
           grid: {fillStyle: '#4072dc'},
	    labels:{fillStyle:'#050207'},
           timestampFormatter:SmoothieChart.timeFormatter
       });
       chartAccY.addTimeSeries(accY, {
           strokeStyle: '#f9ff61',
           fillStyle: 'rgba(248,255,192,0.30)',
           lineWidth: 1
       });
       chartAccY.streamTo(document.getElementById("accYGraph"), 1000);
   }

   function createTimelineAccZ() {
       var chartAccZ = new SmoothieChart({
           maxValue: 1390,
           minValue: 1325,
	   maxValueScale : 1.1,
           minValueScale : 1.1,
           millisPerPixel: 30,
            labels:{disabled:false,
		   fillStyle: '#000000'},
           grid: {fillStyle: '#4072dc'},
           timestampFormatter:SmoothieChart.timeFormatter
       });

       chartAccZ.addTimeSeries(accZ, {
           strokeStyle: '#7cff76',
           fillStyle: 'rgba(230,224,46,0.30)',
           lineWidth: 1
       });

       chartAccZ.streamTo(document.getElementById("accZGraph"), 1000);
   }
	
   function createTimelineBar() {
       var chartBar = new SmoothieChart({
	//	   maxValue : 1013,
       //		   minValue : 985,
           millisPerPixel: 100,
           labels:{disabled:false},
           grid: {fillStyle: '#7afdff'},
           timestampFormatter:SmoothieChart.timeFormatter
       });

       chartBar.addTimeSeries(bar, {
           strokeStyle: '#392637',
           fillStyle: 'rgba(251, 154, 153, 0.2)',
           lineWidth: 4
       });

       chartBar.streamTo(document.getElementById("barGraph"), 1000);
   }
   
   function createTimelineTemp() {
       var chartTemp = new SmoothieChart({
           minValue: 17,
    	   maxValueScale : 1.1,
           minValueScale : 1.2,
           millisPerPixel: 75,
           labels:{disabled:false},
           grid: {fillStyle: 'rgba(0,0,0,1.0)'},
           timestampFormatter:SmoothieChart.timeFormatter
       });

       chartTemp.addTimeSeries(temp, {
           strokeStyle: 'rgba(251, 154, 153, 1)',
           fillStyle: 'rgba(251, 154, 153, 0.2)',
           lineWidth: 4
       });

       chartTemp.streamTo(document.getElementById("tempGraph"), 1000);
   }
   
   createTimelineMagX();
   createTimelineMagY();
   createTimelineMagZ();
   createTimelineAccX();
   createTimelineAccY();
   createTimelineAccZ();
   createTimelineBar();
   createTimelineTemp();
   var socket = io('/');
   socket.on('newdata', function (msg) {
       var sample = JSON.parse(msg);
       console.log(msg);
    //setInterval(function() {
  //    magX.append(new Date().getTime(), Math.random() * 10000);
   //    magY.append(new Date().getTime(), Math.random() * 10000);
    //   magZ.append(new Date().getTime(), Math.random() * 10000);
	//   accX.append(new Date().getTime(), Math.random() * 10000);
//	   accY.append(new Date().getTime(), Math.random() * 10000);
	//   accZ.append(new Date().getTime(), Math.random() * 10000);
    // }, 500);
	
       magX.append(new Date().getTime(), sample.magX);
       magY.append(new Date().getTime(), sample.magY);
       magZ.append(new Date().getTime(), sample.magZ);
       accX.append(new Date().getTime(), sample.accX);
       accY.append(new Date().getTime(), sample.accY);
       accZ.append(new Date().getTime(), sample.accZ);
       bar.append(new Date().getTime(), sample.hPa);
       temp.append(new Date().getTime(), sample.temp);
   });
</script>
  </body>
</html>
